<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026å¥½é‹FUNé¦¬ä¾†</title>
    <!-- è¼‰å…¥ Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ä½¿ç”¨ Inter å­—é«” */
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fb; }
        /* éš±è— Chrome/Safari çš„æ•¸å­—è¼¸å…¥ç®­é ­ */
        input[type='number']::-webkit-inner-spin-button,
        input[type='number']::-webkit-outer-spin-spin {
            -webkit-appearance: none;
            margin: 0;
        }
        /* éš±è— Firefox çš„æ•¸å­—è¼¸å…¥ç®­é ­ */
        input[type='number'] {
            -moz-appearance: textfield;
        }
        /* å¿…å¡«æ¬„ä½æ¨™ç±¤æ¨£å¼ */
        .required-label::after {
            content: '*';
            margin-left: 4px;
            color: #ef4444; /* red-500 */
        }
    </style>
    <script>
        // =======================================================
        // ã€é‡è¦ã€‘å·²æ›´æ–°ç‚ºæ‚¨æä¾›çš„ Google Apps Script éƒ¨ç½² URL
        // =======================================================
        const FORM_URL = "https://script.google.com/macros/s/AKfycbxhOHNd4LeAWAPkQcPUkeIAJJ2b5ng9D-7YuhaXWxXNDpLH7rPfre9zQE3HuvlYskwr/exec"; 
        
        // ç¥¨åƒ¹å›ºå®šåƒ¹æ ¼é» (Price Blocks)
        const PRICE_1_TICKET = 399;     // 1 å¼µåƒ¹æ ¼
        const PRICE_3_TICKETS = 1068;   // 3 å¼µåƒ¹æ ¼
        const PRICE_5_TICKETS = 1688;   // 5 å¼µåƒ¹æ ¼ (é€ 1 å¼µ)
        const BLOCK_SIZE = 5;

        // DOM å…ƒç´ å¼•ç”¨
        let purchasedTicketsInput;
        let totalAmountDisplay;
        let freeTicketsDisplay;
        let totalTicketsReceivedDisplay;
        let submitButton;
        let submissionMessageDiv;
        let form;
        let paymentMethodSelect; // ä»˜æ¬¾æ–¹å¼é¸æ“‡å™¨
        let lastFourDigitsContainer; // æœ«å››ç¢¼è¼¸å…¥æ¡†çš„å®¹å™¨
        let lastFourDigitsInput; // æœ«å››ç¢¼è¼¸å…¥æ¡†æœ¬èº«

        /**
         * åˆå§‹åŒ–æ‰€æœ‰ DOM å…ƒç´ å’Œäº‹ä»¶ç›£è½å™¨ã€‚
         */
        window.onload = function() {
            purchasedTicketsInput = document.getElementById('purchasedTickets');
            totalAmountDisplay = document.getElementById('totalAmount');
            freeTicketsDisplay = document.getElementById('freeTickets');
            totalTicketsReceivedDisplay = document.getElementById('totalTicketsReceived');
            submitButton = document.getElementById('submitButton');
            submissionMessageDiv = document.getElementById('submissionMessage');
            form = document.getElementById('orderForm');

            // æ–°å¢ DOM å¼•ç”¨
            paymentMethodSelect = document.getElementById('paymentMethod');
            lastFourDigitsContainer = document.getElementById('lastFourDigitsContainer');
            lastFourDigitsInput = document.getElementById('lastFourDigits');
            
            // æ–°å¢è¡¨å–®æäº¤äº‹ä»¶ç›£è½å™¨
            form.addEventListener('submit', handleFormSubmit); 

            // åˆå§‹è¼‰å…¥æ™‚åŸ·è¡Œä¸€æ¬¡è¨ˆç®—å’Œé¡¯ç¤ºæ§åˆ¶
            updateCalculation();
            toggleLastFourDigits(); // ç¢ºä¿åˆå§‹ç‹€æ…‹ (æœ«å››ç¢¼æ¬„ä½) æ˜¯éš±è—çš„
        };

        /**
         * å¢åŠ è³¼è²·å¼µæ•¸ã€‚
         */
        function incrementTickets() {
            let current = parseInt(purchasedTicketsInput.value) || 0;
            purchasedTicketsInput.value = current + 1;
            updateCalculation();
        }

        /**
         * æ¸›å°‘è³¼è²·å¼µæ•¸ï¼Œæœ€å°ç‚º 1ã€‚
         */
        function decrementTickets() {
            let current = parseInt(purchasedTicketsInput.value) || 1;
            if (current > 1) {
                purchasedTicketsInput.value = current - 1;
                updateCalculation();
            }
        }

        /**
         * æ ¹æ“šè³¼è²·å¼µæ•¸æ›´æ–°ç¸½é‡‘é¡å’Œç¥¨åˆ¸æ•¸é‡ã€‚
         * æ¡ç”¨åš´æ ¼çš„ã€Œå›ºå®šå¥—é¤çµ„åˆã€å®šåƒ¹é‚è¼¯: å„ªå…ˆä½¿ç”¨ 5 å¼µã€å†ä½¿ç”¨ 3 å¼µã€æœ€å¾Œä½¿ç”¨ 1 å¼µçš„åƒ¹æ ¼ã€‚
         */
        function updateCalculation() {
            // ç²å–å€¼ï¼Œå¦‚æœä¸æ˜¯æœ‰æ•ˆæ•¸å­—æˆ–ç©ºå€¼ï¼Œå‰‡è¦–ç‚º 0
            let purchasedTickets = parseInt(purchasedTicketsInput.value) || 0;
            
            if (purchasedTickets <= 0) {
                totalAmountDisplay.textContent = '0';
                freeTicketsDisplay.textContent = '0';
                totalTicketsReceivedDisplay.textContent = '0';
                document.getElementById('hiddenFreeTickets').value = 0;
                document.getElementById('hiddenTotalTicketsReceived').value = 0;
                document.getElementById('hiddenTotalAmount').value = 0;
                submitButton.disabled = true;
                submitButton.textContent = 'è«‹è¼¸å…¥è³¼è²·å¼µæ•¸å¾Œé€å‡ºè¨‚å–®';
                return;
            }

            let remainingTickets = purchasedTickets;
            let totalAmount = 0;
            let freeTickets = 0;

            // 1. è¨ˆç®— 5 å¼µå¥—ç¥¨å€å¡Š (è²·äº”é€ä¸€)
            const blocksOf5 = Math.floor(remainingTickets / BLOCK_SIZE);
            totalAmount += blocksOf5 * PRICE_5_TICKETS;
            freeTickets += blocksOf5; // æ¯ 5 å¼µè´ˆé€ 1 å¼µ
            remainingTickets %= BLOCK_SIZE;

            // 2. è¨ˆç®—å‰©é¤˜çš„ 3 å¼µå¥—ç¥¨
            const blocksOf3 = Math.floor(remainingTickets / 3);
            totalAmount += blocksOf3 * PRICE_3_TICKETS;
            remainingTickets %= 3;

            // 3. è¨ˆç®—å‰©é¤˜çš„ 1 å¼µå–®ç¥¨ (é¤˜æ•¸åªæœƒæ˜¯ 1 æˆ– 2)
            totalAmount += remainingTickets * PRICE_1_TICKET;

            // 4. æœ€çµ‚è¨ˆç®—
            const totalTicketsReceived = purchasedTickets + freeTickets;

            // 5. æ›´æ–°å‰ç«¯é¡¯ç¤º
            totalAmountDisplay.textContent = totalAmount.toLocaleString('zh-TW'); // æ ¼å¼åŒ–é‡‘é¡
            freeTicketsDisplay.textContent = freeTickets;
            totalTicketsReceivedDisplay.textContent = totalTicketsReceived;

            // å°‡è¨ˆç®—çµæœå„²å­˜ç‚ºéš±è—æ¬„ä½ï¼Œä»¥ä¾¿æ–¼æäº¤
            document.getElementById('hiddenFreeTickets').value = freeTickets;
            document.getElementById('hiddenTotalTicketsReceived').value = totalTicketsReceived;
            document.getElementById('hiddenTotalAmount').value = totalAmount;

            // æª¢æŸ¥è³¼è²·æ•¸é‡æ˜¯å¦åˆç†
            submitButton.disabled = purchasedTickets <= 0;
            if (purchasedTickets > 0) {
                 submitButton.textContent = 'é€å‡ºè¨‚å–®';
            }
        }

        /**
         * æ ¹æ“šä»˜æ¬¾æ–¹å¼é¡¯ç¤ºæˆ–éš±è—ã€Œä»˜æ¬¾æœ«å››ç¢¼ã€æ¬„ä½ã€‚
         */
        function toggleLastFourDigits() {
            const selectedMethod = paymentMethodSelect.value;
            const isBankTransfer = selectedMethod === 'éŠ€è¡Œè½‰å¸³';

            if (isBankTransfer) {
                lastFourDigitsContainer.classList.remove('hidden');
                // ç•¶æ¬„ä½é¡¯ç¤ºæ™‚ï¼Œè¨­å®šç‚ºå¿…å¡«
                lastFourDigitsInput.required = true;
            } else {
                lastFourDigitsContainer.classList.add('hidden');
                // ç•¶æ¬„ä½éš±è—æ™‚ï¼Œç§»é™¤å¿…å¡«å±¬æ€§ä¸¦æ¸…ç©ºå€¼ï¼Œé¿å…æäº¤éŒ¯èª¤
                lastFourDigitsInput.required = false;
                lastFourDigitsInput.value = '';
            }
        }

        /**
         * è™•ç†è¡¨å–®æäº¤äº‹ä»¶ï¼Œç™¼é€æ•¸æ“šåˆ° Apps Script æœå‹™ç«¯é»ã€‚
         * @param {Event} event æäº¤äº‹ä»¶ã€‚
         */
        async function handleFormSubmit(event) {
            event.preventDefault();

            // ç²å–æ‰€æœ‰è¡¨å–®æ•¸æ“š
            const formData = {
                purchaserName: document.getElementById('purchaserName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                region: document.getElementById('region').value,
                lineId: document.getElementById('lineId').value,
                referrer: document.getElementById('referrer').value,
                purchasedTickets: parseInt(document.getElementById('purchasedTickets').value) || 0,
                paymentMethod: document.getElementById('paymentMethod').value,
                // å³ä½¿éš±è—ï¼Œå¦‚æœééŠ€è¡Œè½‰å¸³ï¼Œå€¼ä¹Ÿæœƒæ˜¯ç©ºå­—ä¸²ï¼Œç¬¦åˆéœ€æ±‚
                lastFourDigits: document.getElementById('lastFourDigits').value,
                
                // è®€å–éš±è—çš„è¨ˆç®—çµæœ
                freeTickets: parseInt(document.getElementById('hiddenFreeTickets').value) || 0,
                totalTicketsReceived: parseInt(document.getElementById('hiddenTotalTicketsReceived').value) || 0,
                totalAmount: parseInt(document.getElementById('hiddenTotalAmount').value) || 0
            };
            
            // åŸºç¤é©—è­‰ (å¯æ“´å……æ›´å¤šé©—è­‰é‚è¼¯)
            if (!formData.purchaserName || !formData.phoneNumber || formData.purchasedTickets <= 0) {
                showMessage('error', 'è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½ (å§“åã€æ‰‹æ©Ÿã€è³¼è²·å¼µæ•¸)ã€‚');
                return;
            }

            // è¨­å®šæäº¤ç‹€æ…‹
            submitButton.disabled = true;
            submitButton.textContent = 'è™•ç†ä¸­... è«‹ç¨å€™';
            showMessage('loading', 'æ­£åœ¨å°‡æ‚¨çš„è¨‚å–®æäº¤è‡³ä¼ºæœå™¨...');

            // ç™¼é€ POST è«‹æ±‚åˆ° Apps Script
            try {
                // Apps Script åå¥½ Content-Type: text/plain ä»¥é¿å…è¤‡é›œçš„é æª¢ (pre-flight)
                const response = await fetch(FORM_URL, {
                    method: 'POST',
                    mode: 'cors', // å…è¨± CORS
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8', 
                    },
                    body: JSON.stringify(formData) // å°‡æ•¸æ“šè½‰ç‚º JSON å­—ä¸²å‚³é€
                });
                
                // è§£æ Apps Script å›å‚³çš„ JSON çµæœ
                const result = await response.json(); 

                if (result.status === 200) {
                    showMessage('success', `ğŸ‰ è¨‚å–®é€å‡ºæˆåŠŸï¼<br>è¨Šæ¯: ${result.message}<br><span class="text-sm font-normal mt-1">ï¼ˆè«‹æ³¨æ„ï¼šé€™åªæ˜¯ç³»çµ±è¨˜éŒ„ï¼Œæœ€çµ‚è¨‚å–®ç¢ºèªä»¥å°ˆäººé€šçŸ¥ç‚ºä¸»ï¼‰</span>`);
                    submitButton.textContent = 'âœ… è¨‚å–®å·²æˆåŠŸé€å‡º';
                    form.reset(); // æ¸…ç©ºè¡¨å–®
                    purchasedTicketsInput.value = 1; // é‡è¨­ç‚º 1
                    updateCalculation(); // é‡è¨­è¨ˆç®—é¡¯ç¤º
                    toggleLastFourDigits(); // é‡è¨­æœ«å››ç¢¼æ¬„ä½ç‹€æ…‹
                } else {
                    showMessage('error', `âš ï¸ æäº¤å¤±æ•— (${result.status})ã€‚<br>è¨Šæ¯: ${result.message}`);
                    submitButton.disabled = false;
                    submitButton.textContent = 'è«‹é‡è©¦é€å‡ºè¨‚å–®';
                }

            } catch (error) {
                console.error("Fetch Error:", error);
                showMessage('error', `âŒ ç¶²è·¯éŒ¯èª¤æˆ–ä¼ºæœå™¨ç„¡å›æ‡‰ã€‚<br>è«‹æª¢æŸ¥æ‚¨çš„ Apps Script éƒ¨ç½²ç‹€æ…‹æˆ–ç¶²è·¯é€£ç·šã€‚`);
                submitButton.disabled = false;
                submitButton.textContent = 'è«‹é‡è©¦é€å‡ºè¨‚å–®';
            }
        }
        
        /**
         * é¡¯ç¤ºä¸åŒç‹€æ…‹çš„è¨Šæ¯ã€‚
         * @param {'loading'|'success'|'error'} type è¨Šæ¯é¡å‹ã€‚
         * @param {string} message è¨Šæ¯å…§å®¹ (æ”¯æŒ HTML)ã€‚
         */
        function showMessage(type, message) {
            submissionMessageDiv.innerHTML = message;
            
            switch (type) {
                case 'loading':
                    submissionMessageDiv.className = 'mt-6 p-4 rounded-xl bg-blue-100 text-blue-700 shadow-md animate-pulse';
                    break;
                case 'success':
                    submissionMessageDiv.className = 'mt-6 p-4 rounded-xl bg-green-100 text-green-800 font-bold shadow-md';
                    break;
                case 'error':
                    submissionMessageDiv.className = 'mt-6 p-4 rounded-xl bg-red-100 text-red-800 font-bold shadow-md';
                    break;
            }
            submissionMessageDiv.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-center justify-center">

    <div class="w-full max-w-2xl bg-white shadow-2xl rounded-2xl p-6 md:p-10 border border-gray-100">
        
        <header class="text-center mb-8">
            <h1 class="text-3xl font-extrabold text-indigo-700">2026é ˜é ­é¦¬è¨ˆåŠƒå¥½é‹FUNé¦¬ä¾†</p>é«”é©—å·è³¼ç¥¨</h1>
            <p class="mt-2 text-gray-500"> </p>
            
            <!-- ã€æ–°å¢åœ–ç‰‡å€å¡Šã€‘ -->
            <div class="my-6">
                <!-- åœ–ç‰‡ç¶²å€å·²æ›¿æ›ç‚ºä½¿ç”¨è€…æä¾›çš„é€£çµ -->
                <img src="https://chy0205.github.io/0217/0217.png" 
                     onerror="this.onerror=null;this.src='https://placehold.co/600x200/5C6BC0/ffffff?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';"
                     alt="2026å¥½é‹FUNé¦¬ä¾†æ´»å‹•å®£å‚³åœ–" 
                     class="w-full max-h-96 object-contain rounded-lg shadow-xl mx-auto border border-gray-100">
            </div>
            <!-- ã€çµæŸæ–°å¢åœ–ç‰‡å€å¡Šã€‘ -->
            
            <!-- ç¥¨åƒ¹å„ªæƒ æ–¹æ¡ˆå€å¡Š (å·²æ›´æ–°ç‚ºåˆ—è¡¨æ ¼å¼) -->
            <div class="mt-4 p-4 bg-indigo-50 rounded-lg shadow-inner text-left">

    <!-- ç½®ä¸­ï¼šç¥¨åƒ¹å„ªæƒ æ–¹æ¡ˆ -->
    <h2 class="text-lg font-bold text-indigo-700 mb-2 text-center">
        ç¥¨åƒ¹å„ªæƒ æ–¹æ¡ˆ
    </h2>

    <ul class="space-y-1 text-gray-700 list-disc list-inside ml-4">
        <li class="text-sm">å–®å¼µè³¼è²·ï¼š<span class="font-bold text-blue-600">NT$ 399 / å¼µ</span></li>
        <li class="text-sm">ä¸‰å¼µå¥—ç¥¨ï¼š<span class="font-bold text-blue-600">NT$ 1068 / 3 å¼µ</li>
        <li class="text-sm">
            <span class="font-extrabold text-green-700">è²·äº”é€ä¸€ï¼š</span>
            <span class="font-bold text-blue-700">NT$ 1688 / 5 å¼µ</span>
            <span class="text-gray-500"></span>
        </li>
    </ul>

    <!-- æ–°å¢éŠ€è¡Œè½‰å¸³è³‡è¨Š -->
    <p class="mt-3 text-sm text-gray-800 font-medium text-center">
        <span class="font-bold text-indigo-700">éŠ€è¡Œè½‰å¸³ï¼š</span>é™³é©Šå»·(812)00310102746800<br>
        <span class="text-xs text-gray-500">ï¼ˆåŒ¯æ¬¾æ™‚å‚™è¨»è«‹å¯«è³¼è²·äººä»¥åˆ©æŸ¥å¸³ï¼‰</span>
    </p>
    <!-- çµæŸæ–°å¢éŠ€è¡Œè½‰å¸³è³‡è¨Š -->

    <!-- ç½®ä¸­ï¼šç™¼æ”¾é«”é©—åˆ¸ -->
    <p class="mt-3 text-sm font-bold text-red-600 border-t border-indigo-200 pt-2 text-center">
        ç™¼æ”¾é«”é©—åˆ¸ & æ”¶ç¾é‡‘è² è²¬äºº
    </p>

    <p class="text-sm">å…‰æ˜ï¼šç›§æ€å¦¤ 0919-359-679ã€€ã€€å¤©æ…§ï¼šæ¥Šç§‹ç² 0919-359-679</p>
    <p class="text-sm">è¯å¾·ï¼šå¼µæƒ å› 0923-394-167ã€€ã€€å…‰è¼ï¼šè¨±é›¯æ™´ 0979-710-125</p>
    <p class="text-sm">å…‰é›„ï¼šé™³å“²å® 0910-516-213ã€€ã€€å…‰è€€ï¼šç¿æ”¿å±€ 0960-301-231</p>
    <p class="text-sm">å´‡æ­£ï¼šå¼µç‘„èŠ¸ 0983-836-607</p>

</div>

            <!-- çµæŸ ç¥¨åƒ¹å„ªæƒ æ–¹æ¡ˆå€å¡Š -->
            
        </header>

        <form id="orderForm" class="space-y-6">
            
            <!-- å€å¡Š 1: åŸºæœ¬è¯çµ¡è³‡è¨Š -->
            <fieldset class="border p-5 rounded-xl space-y-4 bg-gray-50/50">
                <legend class="text-lg font-semibold text-gray-700 px-2">è³¼ç¥¨äººè³‡è¨Š</legend>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="purchaserName" class="block text-sm font-medium text-gray-700 required-label">è³¼ç¥¨äººå§“å</label>
                        <input type="text" id="purchaserName" name="purchaserName" required
                               class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3">
                    </div>
                    <div>
                        <label for="phoneNumber" class="block text-sm font-medium text-gray-700 required-label">æ‰‹æ©Ÿè™Ÿç¢¼</label>
                        <input type="tel" id="phoneNumber" name="phoneNumber" required pattern="[0-9]{10}" placeholder="ä¾‹å¦‚: 0912345678"
                               class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- æ‰€åœ¨å€åŸŸå·²æ”¹ç‚ºæ–‡å­—è¼¸å…¥ -->
                    <div>
                        <label for="region" class="block text-sm font-medium text-gray-700">å€åŸŸ</label>
                        <input type="text" id="region" name="region" placeholder="è«‹è¼¸å…¥æ‰€å±¬å€åŸŸ"
                               class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3">
                    </div>
                    <div>
                        <label for="lineId" class="block text-sm font-medium text-gray-700">Line ID (é¸å¡«)</label>
                        <input type="text" id="lineId" name="lineId"
                               class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3">
                    </div>
                </div>

                <div>
                    <label for="referrer" class="block text-sm font-medium text-gray-700">æ¨è–¦äººå§“å (é¸å¡«)</label>
                    <input type="text" id="referrer" name="referrer"
                           class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3">
                </div>
            </fieldset>

            <!-- å€å¡Š 2: ç¥¨åˆ¸æ•¸é‡èˆ‡è¨ˆç®— -->
            <fieldset class="border p-5 rounded-xl space-y-4 bg-indigo-50/50">
                <legend class="text-lg font-semibold text-gray-700 px-2">ç¥¨åˆ¸æ•¸é‡è¨ˆç®—</legend>

                <div>
                    <label for="purchasedTickets" class="block text-sm font-bold text-indigo-700 required-label">
                        è³¼è²·å¼µæ•¸
                    </label>
                    <!-- è³¼è²·å¼µæ•¸ï¼šå·²ç§»é™¤ readonlyï¼Œä¸¦æ–°å¢ oninput è®“ä½¿ç”¨è€…å¯æ‰‹å‹•è¼¸å…¥ -->
                    <div class="flex mt-1 rounded-lg overflow-hidden border border-indigo-300 shadow-md">
                        <button type="button" onclick="decrementTickets()" 
                                class="p-3 bg-indigo-200 text-indigo-700 font-extrabold text-3xl hover:bg-indigo-300 transition duration-150 w-1/4 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-8 h-8">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14" />
                            </svg>
                        </button>
                        <input type="number" id="purchasedTickets" name="purchasedTickets" value="1" min="1" required oninput="updateCalculation()"
                               class="block w-2/4 bg-white border-x border-indigo-300 focus:outline-none p-3 text-3xl text-center font-extrabold appearance-none text-indigo-800">
                        <button type="button" onclick="incrementTickets()" 
                                class="p-3 bg-indigo-200 text-indigo-700 font-extrabold text-3xl hover:bg-indigo-300 transition duration-150 w-1/4 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor" class="w-8 h-8">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="space-y-2">
                    <div class="flex justify-between items-center p-3 bg-white rounded-lg shadow-sm">
                        <span class="text-sm font-medium text-gray-600">å…è²»è´ˆé€å¼µæ•¸ (æ¯ 5 å¼µè´ˆ 1 å¼µ)</span>
                        <span id="freeTickets" class="text-xl font-bold text-green-600">0</span>
                    </div>

                    <div class="flex justify-between items-center p-3 bg-white rounded-lg shadow-sm">
                        <span class="text-sm font-medium text-gray-600">æœ€çµ‚ç²å¾—ç¸½ç¥¨æ•¸ (ä»˜è²» + è´ˆé€)</span>
                        <span id="totalTicketsReceived" class="text-xl font-bold text-indigo-600">1</span>
                    </div>

                    <div class="flex justify-between items-center p-4 bg-indigo-700 text-white rounded-lg shadow-lg">
                        <span class="text-lg font-bold">æ‡‰ä»˜ç¸½é‡‘é¡ (TWD)</span>
                        <span class="text-3xl font-extrabold">$<span id="totalAmount">399</span></span>
                    </div>
                </div>
                
                <!-- éš±è—æ¬„ä½ç”¨æ–¼æäº¤è¨ˆç®—çµæœçµ¦ Apps Script -->
                <input type="hidden" id="hiddenFreeTickets" name="freeTickets">
                <input type="hidden" id="hiddenTotalTicketsReceived" name="totalTicketsReceived">
                <input type="hidden" id="hiddenTotalAmount" name="totalAmount">
            </fieldset>

            <!-- å€å¡Š 3: ä»˜æ¬¾è³‡è¨Š -->
            <fieldset class="border p-5 rounded-xl space-y-4 bg-gray-50/50">
                <legend class="text-lg font-semibold text-gray-700 px-2">ä»˜æ¬¾è³‡è¨Š</legend>

                <div>
                    <label for="paymentMethod" class="block text-sm font-medium text-gray-700 required-label">ä»˜æ¬¾æ–¹å¼</label>
                    <select id="paymentMethod" name="paymentMethod" required onchange="toggleLastFourDigits()"
                            class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3">
                        <option value="">è«‹é¸æ“‡ä»˜æ¬¾æ–¹å¼</option>
                        <!-- æ ¹æ“šä½¿ç”¨è€…è¦æ±‚æ›´æ–°é¸é … -->
                        <option value="ç¾é‡‘æ”¯ä»˜">ç¾é‡‘æ”¯ä»˜</option>
                        <option value="éŠ€è¡Œè½‰å¸³">éŠ€è¡Œè½‰å¸³(åŒ¯æ¬¾æ™‚å‚™è¨»è«‹å¯«è³¼è²·äººä»¥åˆ©æŸ¥å¸³)</option>
                    </select>
                </div>
                
                <!-- æ–°å¢ ID å’Œ hidden classï¼Œä¸¦å°‡ required å±¬æ€§ç§»é™¤ï¼Œç”± JS æ§ç®¡ -->
                <div id="lastFourDigitsContainer" class="hidden">
                    <label for="lastFourDigits" class="block text-sm font-medium text-gray-700 required-label">
                        ä»˜æ¬¾æœ«å››ç¢¼ / äº¤æ˜“åºè™Ÿ
                    </label>
                    <input type="text" id="lastFourDigits" name="lastFourDigits" maxlength="4" placeholder="ä¾‹å¦‚: éŠ€è¡Œè½‰å¸³æœ«å››ç¢¼æˆ–äº¤æ˜“ç·¨è™Ÿ"
                           class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3">
                </div>
            </fieldset>

            <!-- æäº¤æŒ‰éˆ• -->
            <button type="submit" id="submitButton" disabled
                    class="w-full py-4 px-4 bg-indigo-600 text-white font-bold text-lg rounded-xl shadow-lg hover:bg-indigo-700 transition duration-150 disabled:bg-indigo-300">
                è«‹è¼¸å…¥è³¼è²·å¼µæ•¸å¾Œé€å‡ºè¨‚å–®
            </button>
        </form>

        <!-- æäº¤çµæœè¨Šæ¯å€ -->
        <div id="submissionMessage" class="mt-6">
            <!-- è¨Šæ¯å°‡æœƒé¡¯ç¤ºåœ¨é€™è£¡ -->
        </div>

    </div>

</body>
</html>
